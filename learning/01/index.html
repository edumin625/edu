<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ë‹¨ì–´ í•™ìŠµ ì•±</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Styles for better card/button aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        .flashcard {
            min-height: 400px; /* í”Œë˜ì‹œ ì¹´ë“œ ë†’ì´ ìœ ì§€ */
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1000px;
            cursor: pointer;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .flashcard.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding-left: 20px;
            padding-right: 20px;
            padding-top: 40px; /* ìƒë‹¨ ì—¬ë°± ì¶”ê°€ */
            padding-bottom: 40px; /* í•˜ë‹¨ ì—¬ë°± ì¶”ê°€ */
            box-sizing: border-box; /* íŒ¨ë”©ì´ ì „ì²´ í¬ê¸°ì— í¬í•¨ë˜ë„ë¡ ì„¤ì • */
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }
        .card-front {
            background-color: #ffffff;
            color: #1f2937;
            font-size: 3rem;
            font-weight: 700;
        }
        .card-back {
            background-color: #4f46e5;
            color: #ffffff;
            transform: rotateY(180deg);
            font-size: 2rem;
            font-weight: 600;
        }
        .quiz-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .correct {
            background-color: #10b981 !important; /* Tailwind green-500 */
            color: white !important;
            border-color: #059669 !important;
            pointer-events: none;
        }
        .incorrect {
            background-color: #ef4444 !important; /* Tailwind red-500 */
            color: white !important;
            border-color: #dc2626 !important;
            pointer-events: none;
        }
        /* New styles for Word Game 1 */
        .scrambled-word {
            letter-spacing: 0.5rem;
        }
        /* New styles for Word Game 2 (Canvas) */
        #gameCanvas {
            border: 4px solid #4f46e5; /* Indigo border */
            background-color: #1f2937; /* Dark background */
            border-radius: 1rem;
            display: block;
            margin: 0 auto;
            touch-action: none; /* Disable default touch actions */
        }
        .game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-4xl mx-auto bg-white p-6 md:p-10 rounded-xl shadow-2xl">
        <h1 class="text-4xl font-extrabold text-indigo-700 mb-6 text-center">ì˜ë‹¨ì–´ í•™ìŠµ ë§ˆìŠ¤í„°</h1>

        <!-- Mode Selection -->
        <div class="flex justify-center space-x-3 mb-8 flex-wrap gap-y-3">
            <button id="flashcardModeBtn" onclick="setMode('flashcard')" class="px-4 py-2 font-semibold rounded-lg transition duration-150 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300 shadow-md text-sm md:text-base">
                í”Œë˜ì‹œ ì¹´ë“œ í•™ìŠµ
            </button>
            <button id="quizModeBtn" onclick="setMode('quiz')" class="px-4 py-2 font-semibold rounded-lg transition duration-150 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300 shadow-md text-sm md:text-base">
                í€´ì¦ˆ í’€ì´
            </button>
            <button id="wordgameModeBtn" onclick="setMode('wordgame')" class="px-4 py-2 font-semibold rounded-lg transition duration-150 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300 shadow-md text-sm md:text-base">
                ì˜ë‹¨ì–´ ê²Œì„
            </button>
            <button id="wordgame2ModeBtn" onclick="setMode('wordgame2')" class="px-4 py-2 font-semibold rounded-lg transition duration-150 ease-in-out bg-gray-200 text-gray-800 hover:bg-gray-300 shadow-md text-sm md:text-base">
                ì˜ë‹¨ì–´ ê²Œì„2 (ë‚™í•˜)
            </button>
        </div>

        <!-- Word Status and Control -->
        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 space-y-3 sm:space-y-0">
            <div id="wordStatus" class="text-lg font-medium text-gray-700"></div>
            <div class="flex space-x-3">
                <select id="categoryFilter" onchange="resetApp()" class="px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="all">ì „ì²´ ë‹¨ì–´</option>
                </select>
                <button onclick="resetApp()" class="px-4 py-2 bg-pink-500 text-white font-semibold rounded-lg shadow-md hover:bg-pink-600 transition duration-150 ease-in-out">
                    ì¬ì‹œì‘
                </button>
            </div>
        </div>

        <!-- Main Content Area (Flashcard / Quiz / Word Game) -->
        <div id="appContainer">
            <!-- Content will be rendered here by JavaScript -->
        </div>

        <!-- Navigation Buttons (Flashcard only) -->
        <div id="navControls" class="flex justify-center space-x-4 mt-8 hidden">
            <button onclick="prevWord()" class="px-6 py-3 text-lg font-bold rounded-full bg-gray-700 text-white hover:bg-gray-800 transition duration-150 ease-in-out shadow-lg">
                <span class="text-2xl">&larr;</span> ì´ì „
            </button>
            <button onclick="nextWord()" class="px-6 py-3 text-lg font-bold rounded-full bg-indigo-700 text-white hover:bg-indigo-800 transition duration-150 ease-in-out shadow-lg">
                ë‹¤ìŒ <span class="text-2xl">&rarr;</span>
            </button>
        </div>

        <!-- Quiz Result Modal (Custom alert replacement) -->
        <div id="resultModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center hidden">
            <div class="bg-white p-8 rounded-xl shadow-2xl max-w-sm w-full text-center">
                <h3 id="modalTitle" class="text-2xl font-bold mb-4 text-indigo-700"></h3>
                <p id="modalMessage" class="mb-6 text-gray-700"></p>
                <button id="modalContinueBtn" onclick="handleModalContinue()" class="px-6 py-2 bg-indigo-500 text-white font-semibold rounded-lg hover:bg-indigo-600">
                    ê³„ì†í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        // ì˜ë‹¨ì–´ ë°ì´í„°: 100ê°œ ë‹¨ì–´ ëª©ë¡
        const ALL_WORD_DATA = [
            { id: 1, english: 'happy', korean: 'í–‰ë³µí•œ', category: 'ê°ì •' },
            { id: 2, english: 'delighted', korean: 'ê¸°ìœ', category: 'ê°ì •' },
            { id: 3, english: 'satisfied', korean: 'ë§Œì¡±í•œ', category: 'ê°ì •' },
            { id: 4, english: 'amazed', korean: 'ë†€ë¼ìš´', category: 'ê°ì •' },
            { id: 5, english: 'proud', korean: 'ìë‘ìŠ¤ëŸ¬ìš´', category: 'ê°ì •' },
            { id: 6, english: 'confident', korean: 'ìì‹ ìˆëŠ”', category: 'ê°ì •' },
            { id: 7, english: 'healthy', korean: 'ê±´ê°•í•œ', category: 'ê°ì •' },
            { id: 8, english: 'sick', korean: 'ì•„í”ˆ', category: 'ê°ì •' },
            { id: 9, english: 'interested', korean: 'í¥ë¯¸ë¡œìš´', category: 'ê°ì •' },
            { id: 10, english: 'excited', korean: 'í¥ë¶„í•œ', category: 'ê°ì •' },
            { id: 11, english: 'jealous', korean: 'ì§ˆíˆ¬í•˜ëŠ”', category: 'ê°ì •' },
            { id: 12, english: 'annoyed', korean: 'ì§œì¦ë‚˜ëŠ”', category: 'ê°ì •' },
            { id: 13, english: 'angry', korean: 'í™”ë‚œ', category: 'ê°ì •' },
            { id: 14, english: 'worried', korean: 'ê±±ì •í•˜ëŠ”', category: 'ê°ì •' },
            { id: 15, english: 'embarrassing', korean: 'ë‚œì²˜í•œ', category: 'ê°ì •' },
            { id: 16, english: 'lonely', korean: 'ì™¸ë¡œìš´', category: 'ê°ì •' },
            { id: 17, english: 'afraid', korean: 'ë¬´ì„œìš´', category: 'ê°ì •' },
            { id: 18, english: 'scared', korean: 'ê²ë‚˜ëŠ”', category: 'ê°ì •' },
            { id: 19, english: 'disappointed', korean: 'ì‹¤ë§í•œ', category: 'ê°ì •' },
            { id: 20, english: 'hungry', korean: 'ë°°ê³ í”ˆ', category: 'ìƒíƒœ' },
            { id: 21, english: 'sleepy', korean: 'ì¡¸ë¦°', category: 'ìƒíƒœ' },
            { id: 22, english: 'thirsty', korean: 'ëª©ë§ˆë¥¸', category: 'ìƒíƒœ' },
            { id: 23, english: 'full', korean: 'ë°°ë¶€ë¥¸', category: 'ìƒíƒœ' },
            { id: 24, english: 'tired', korean: 'í”¼ê³¤í•œ', category: 'ìƒíƒœ' },
            { id: 25, english: 'exhausted', korean: 'ì§€ì¹œ', category: 'ìƒíƒœ' },
            { id: 26, english: 'honest', korean: 'ì •ì§í•œ', category: 'ì„±ê²©' },
            { id: 27, english: 'cautious', korean: 'ì‹ ì¤‘í•œ', category: 'ì„±ê²©' },
            { id: 28, english: 'positive', korean: 'ê¸ì •ì ì¸', category: 'ì„±ê²©' },
            { id: 29, english: 'negative', korean: 'ë¶€ì •ì ì¸', category: 'ì„±ê²©' },
            { id: 30, english: 'serious', korean: 'ì§„ì§€í•œ', category: 'ì„±ê²©' },
            { id: 31, english: 'fun', korean: 'ì¦ê±°ìš´', category: 'ì„±ê²©' },
            { id: 32, english: 'funny', korean: 'ì›ƒê¸´', category: 'ì„±ê²©' },
            { id: 33, english: 'quiet', korean: 'ì¡°ìš©í•œ', category: 'ì„±ê²©' },
            { id: 34, english: 'shy', korean: 'ìˆ˜ì¤ì€', category: 'ì„±ê²©' },
            { id: 35, english: 'introverted', korean: 'ë‚´í–¥ì ì¸', category: 'ì„±ê²©' },
            { id: 36, english: 'extroverted', korean: 'ì™¸í–¥ì ì¸', category: 'ì„±ê²©' },
            { id: 37, english: 'humorous', korean: 'ìœ ë¨¸ëŸ¬ìŠ¤í•œ', category: 'ì„±ê²©' },
            { id: 38, english: 'brave', korean: 'ìš©ê°í•œ', category: 'ì„±ê²©' },
            { id: 39, english: 'cruel', korean: 'ì”ì¸í•œ', category: 'ì„±ê²©' },
            { id: 40, english: 'furious', korean: 'ëª¹ì‹œ í™”ë‚œ', category: 'ì„±ê²©' },
            { id: 41, english: 'diligent', korean: 'ë¶€ì§€ëŸ°í•œ', category: 'ì„±ê²©' },
            { id: 42, english: 'lazy', korean: 'ê²Œìœ¼ë¥¸', category: 'ì„±ê²©' },
            { id: 43, english: 'polite', korean: 'ì˜ˆì˜ë°”ë¥¸', category: 'ì„±ê²©' },
            { id: 44, english: 'rude', korean: 'ë¬´ë¡€í•œ', category: 'ì„±ê²©' },
            { id: 45, english: 'kind', korean: 'ì¹œì ˆí•œ', category: 'ì„±ê²©' },
            { id: 46, english: 'smart', korean: 'ë˜‘ë˜‘í•œ', category: 'ì„±ê²©' },
            { id: 47, english: 'clever', korean: 'ì˜ë¦¬í•œ', category: 'ì„±ê²©' },
            { id: 48, english: 'wise', korean: 'í˜„ëª…í•œ', category: 'ì„±ê²©' },
            { id: 49, english: 'strong', korean: 'ê°•í•œ', category: 'íŠ¹ì„±' },
            { id: 50, english: 'weak', korean: 'ì•½í•œ', category: 'íŠ¹ì„±' },
            { id: 51, english: 'fast', korean: 'ë¹ ë¥¸', category: 'íŠ¹ì„±' },
            { id: 52, english: 'slow', korean: 'ëŠë¦°', category: 'íŠ¹ì„±' },
            { id: 53, english: 'big', korean: 'í°', category: 'íŠ¹ì„±' },
            { id: 54, english: 'small', korean: 'ì‘ì€', category: 'íŠ¹ì„±' },
            { id: 55, english: 'tall', korean: 'í‚¤ê°€ í°', category: 'íŠ¹ì„±' },
            { id: 56, english: 'short', korean: 'í‚¤ê°€ ì‘ì€/ì§§ì€', category: 'íŠ¹ì„±' },
            { id: 57, english: 'long', korean: 'ê¸´', category: 'íŠ¹ì„±' },
            { id: 58, english: 'new', korean: 'ìƒˆë¡œìš´', category: 'íŠ¹ì„±' },
            { id: 59, english: 'old', korean: 'ë‚¡ì€/ë‚˜ì´ë“ ', category: 'íŠ¹ì„±' },
            { id: 60, english: 'young', korean: 'ì Šì€', category: 'íŠ¹ì„±' },
            { id: 61, english: 'beautiful', korean: 'ì•„ë¦„ë‹¤ìš´', category: 'íŠ¹ì„±' },
            { id: 62, english: 'ugly', korean: 'ëª»ìƒê¸´', category: 'íŠ¹ì„±' },
            { id: 63, english: 'pretty', korean: 'ì˜ˆìœ', category: 'íŠ¹ì„±' },
            { id: 64, english: 'handsome', korean: 'ì˜ìƒê¸´', category: 'íŠ¹ì„±' },
            { id: 65, english: 'delicious', korean: 'ë§›ìˆëŠ”', category: 'íŠ¹ì„±' },
            { id: 66, english: 'tasty', korean: 'í’ë¯¸ìˆëŠ”', category: 'íŠ¹ì„±' },
            { id: 67, english: 'sweet', korean: 'ë‹¬ì½¤í•œ', category: 'íŠ¹ì„±' },
            { id: 68, english: 'sour', korean: 'ì‹ ', category: 'íŠ¹ì„±' },
            { id: 69, english: 'bitter', korean: 'ì“´', category: 'íŠ¹ì„±' },
            { id: 70, english: 'salty', korean: 'ì§ ', category: 'íŠ¹ì„±' },
            { id: 71, english: 'warm', korean: 'ë”°ëœ»í•œ', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 72, english: 'hot', korean: 'ëœ¨ê±°ìš´/ë”ìš´', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 73, english: 'cool', korean: 'ì‹œì›í•œ', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 74, english: 'cold', korean: 'ì¶”ìš´/ì°¨ê°€ìš´', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 75, english: 'sunny', korean: 'í™”ì°½í•œ', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 76, english: 'cloudy', korean: 'íë¦°', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 77, english: 'rainy', korean: 'ë¹„ì˜¤ëŠ”', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 78, english: 'snowy', korean: 'ëˆˆì˜¤ëŠ”', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 79, english: 'windy', korean: 'ë°”ëŒë¶€ëŠ”', category: 'ë‚ ì”¨/ì˜¨ë„' },
            { id: 80, english: 'comfortable', korean: 'í¸ì•ˆí•œ', category: 'ìƒíƒœ' },
            { id: 81, english: 'convenient', korean: 'í¸ë¦¬í•œ', category: 'ìƒíƒœ' },
            { id: 82, english: 'safe', korean: 'ì•ˆì „í•œ', category: 'ìƒíƒœ' },
            { id: 83, english: 'dangerous', korean: 'ìœ„í—˜í•œ', category: 'ìƒíƒœ' },
            { id: 84, english: 'difficult', korean: 'ì–´ë ¤ìš´', category: 'ìƒíƒœ' },
            { id: 85, english: 'easy', korean: 'ì‰¬ìš´', category: 'ìƒíƒœ' },
            { id: 86, english: 'important', korean: 'ì¤‘ìš”í•œ', category: 'ìƒíƒœ' },
            { id: 87, english: 'necessary', korean: 'í•„ìš”í•œ', category: 'ìƒíƒœ' },
            { id: 88, english: 'possible', korean: 'ê°€ëŠ¥í•œ', category: 'ìƒíƒœ' },
            { id: 89, english: 'impossible', korean: 'ë¶ˆê°€ëŠ¥í•œ', category: 'ìƒíƒœ' },
            { id: 90, english: 'clear', korean: 'ë§‘ì€/ë¶„ëª…í•œ', category: 'ìƒíƒœ' },
            { id: 91, english: 'dark', korean: 'ì–´ë‘ìš´', category: 'ìƒíƒœ' },
            { id: 92, english: 'bright', korean: 'ë°ì€', category: 'ìƒíƒœ' },
            { id: 93, english: 'clean', korean: 'ê¹¨ë—í•œ', category: 'ìƒíƒœ' },
            { id: 94, english: 'dirty', korean: 'ë”ëŸ¬ìš´', category: 'ìƒíƒœ' },
            { id: 95, english: 'expensive', korean: 'ë¹„ì‹¼', category: 'ê°€ê²©' },
            { id: 96, english: 'cheap', korean: 'ì‹¼', category: 'ê°€ê²©' },
            { id: 97, english: 'common', korean: 'í”í•œ', category: 'ì¼ë°˜' },
            { id: 98, english: 'special', korean: 'íŠ¹ë³„í•œ', category: 'ì¼ë°˜' },
            { id: 99, english: 'whole', korean: 'ì „ì²´ì˜', category: 'ì¼ë°˜' },
            { id: 100, english: 'various', korean: 'ë‹¤ì–‘í•œ', category: 'ì¼ë°˜' },
        ];

        let words = []; // í˜„ì¬ í•™ìŠµ/í€´ì¦ˆì— ì‚¬ìš©ë˜ëŠ” ë‹¨ì–´ ëª©ë¡
        let currentWordIndex = 0;
        let currentMode = 'flashcard'; // 'flashcard', 'quiz', 'wordgame', or 'wordgame2'
        let quizScore = 0;
        let quizTotal = 0;

        // Word Game 1 State
        let gameScore = 0;
        let gameTotal = 0;
        let currentGameWord = null;
        let hintCount = 0;

        // Word Game 2 State
        const GAME_WIDTH = 600;
        const GAME_HEIGHT = 400;
        let canvas, ctx;
        let fallingWords = []; // Array of { word, english, korean, x, y, speed, scoreAwarded }
        let gameLoopId;
        let isGameRunning = false;
        let gameScore2 = 0;
        let wordsMissed = 0;
        let wordsTyped = 0;
        let lastSpawnTime = 0;
        const SPAWN_INTERVAL_MS = 1500; // ë‹¨ì–´ ìƒì„± ê°„ê²© (1.5ì´ˆ)

        document.addEventListener('DOMContentLoaded', () => {
            initializeCategories();
            setMode('flashcard');
        });

        // ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ ì´ˆê¸°í™”
        function initializeCategories() {
            const categories = [...new Set(ALL_WORD_DATA.map(word => word.category))];
            const filterSelect = document.getElementById('categoryFilter');

            categories.forEach(category => {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                filterSelect.appendChild(option);
            });
        }

        // ì•± ìƒíƒœë¥¼ ì´ˆê¸°í™”í•˜ê³  ëª¨ë“œì— ë”°ë¼ ë Œë”ë§
        function resetApp() {
            // ê²Œì„ ë£¨í”„ ì •ì§€ (Word Game 2)
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                isGameRunning = false;
            }
            
            const filterValue = document.getElementById('categoryFilter').value;
            words = filterValue === 'all'
                ? [...ALL_WORD_DATA]
                : ALL_WORD_DATA.filter(word => word.category === filterValue);

            // ë‹¨ì–´ ìˆœì„œ ëœë¤í™”
            words.sort(() => Math.random() - 0.5);

            currentWordIndex = 0;
            quizScore = 0;
            quizTotal = 0;
            gameScore = 0;
            gameTotal = 0;
            hintCount = 0;
            currentGameWord = null;
            
            // Game 2 Reset
            gameScore2 = 0;
            wordsMissed = 0;
            wordsTyped = 0;
            fallingWords = [];

            if (currentMode === 'flashcard') {
                renderFlashcard();
            } else if (currentMode === 'quiz') {
                renderQuiz();
            } else if (currentMode === 'wordgame') {
                nextGameWord();
            } else if (currentMode === 'wordgame2') {
                renderWordGame2();
            }
            updateModeButtons();
        }

        // ëª¨ë“œ ì„¤ì • ë° ì•± ì¬ì‹œì‘
        function setMode(mode) {
            currentMode = mode;
            // Word Game 2ì—ì„œ Canvasê°€ ê³„ì† ê·¸ë ¤ì§€ëŠ” ê²ƒì„ ë°©ì§€
            if (gameLoopId) {
                cancelAnimationFrame(gameLoopId);
                isGameRunning = false;
            }

            document.getElementById('navControls').classList.toggle('hidden', mode !== 'flashcard');
            resetApp();
        }

        // ëª¨ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
        function updateModeButtons() {
            const modes = ['flashcard', 'quiz', 'wordgame', 'wordgame2'];
            modes.forEach(mode => {
                const btn = document.getElementById(`${mode}ModeBtn`);
                if (mode === currentMode) {
                    btn.classList.replace('bg-gray-200', 'bg-indigo-500');
                    btn.classList.replace('text-gray-800', 'text-white');
                } else {
                    btn.classList.replace('bg-indigo-500', 'bg-gray-200');
                    btn.classList.replace('text-white', 'text-gray-800');
                }
            });
        }

        // ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateStatus() {
            const statusElement = document.getElementById('wordStatus');
            const totalWords = words.length;

            if (currentMode === 'flashcard') {
                statusElement.textContent = `ë‹¨ì–´ ${currentWordIndex + 1} / ${totalWords} (${words[currentWordIndex]?.category || ''})`;
            } else if (currentMode === 'quiz') {
                statusElement.textContent = `ì ìˆ˜: ${quizScore} / ${quizTotal} (ë‚¨ì€ ë¬¸ì œ: ${totalWords - quizTotal})`;
            } else if (currentMode === 'wordgame') {
                statusElement.textContent = `ì ìˆ˜: ${gameScore} / ${gameTotal} | ë‚¨ì€ ë¬¸ì œ: ${totalWords - gameTotal} | íŒíŠ¸ ì‚¬ìš©: ${hintCount}íšŒ`;
            } else if (currentMode === 'wordgame2') {
                 statusElement.innerHTML = `
                    <span class="text-xl font-bold text-indigo-700">ì ìˆ˜: ${gameScore2}</span> 
                    | ë§í˜: <span class="text-green-600">${wordsTyped}</span> 
                    | ë†“ì¹¨: <span class="text-red-600">${wordsMissed}</span>
                    | ì´ ë‹¨ì–´: ${words.length}ê°œ
                `;
            }
        }

        // --- Flashcard Mode Functions ---

        // í”Œë˜ì‹œ ì¹´ë“œ ë Œë”ë§
        function renderFlashcard() {
            if (words.length === 0) {
                document.getElementById('appContainer').innerHTML = '<p class="text-center text-xl text-gray-500 mt-10">ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì— ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                document.getElementById('navControls').classList.add('hidden');
                document.getElementById('wordStatus').textContent = '';
                return;
            }

            const currentWord = words[currentWordIndex];
            const appContainer = document.getElementById('appContainer');

            appContainer.innerHTML = `
                <div id="flashcard" class="flashcard w-full max-w-lg mx-auto" onclick="flipCard(this)">
                    <div class="card-inner">
                        <div class="card-front">
                            ${currentWord.english}
                        </div>
                        <div class="card-back">
                            ${currentWord.korean}
                        </div>
                    </div>
                </div>
                <p class="text-center text-sm text-gray-500 mt-4">í´ë¦­í•˜ì—¬ ëœ» í™•ì¸</p>
            `;
            updateStatus();
        }

        // ì¹´ë“œ ë’¤ì§‘ê¸°
        function flipCard(cardElement) {
            cardElement.classList.toggle('flipped');
        }

        // ë‹¤ìŒ ë‹¨ì–´
        function nextWord() {
            currentWordIndex = (currentWordIndex + 1) % words.length;
            renderFlashcard();
        }

        // ì´ì „ ë‹¨ì–´
        function prevWord() {
            currentWordIndex = (currentWordIndex - 1 + words.length) % words.length;
            renderFlashcard();
        }

        // --- Quiz Mode Functions (Simplified) ---
        
        // í€´ì¦ˆ ë¬¸ì œ ë Œë”ë§
        function renderQuiz() {
            // ... (Quiz rendering logic) ...
            if (words.length === 0) {
                document.getElementById('appContainer').innerHTML = '<p class="text-center text-xl text-gray-500 mt-10">ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì— ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                document.getElementById('navControls').classList.add('hidden');
                document.getElementById('wordStatus').textContent = '';
                return;
            }
            
            if (quizTotal >= words.length) {
                showQuizResult();
                return;
            }

            const currentQuestion = words[quizTotal]; // í˜„ì¬ í€´ì¦ˆ ë‹¨ì–´
            const correctAnswer = currentQuestion.english;

            // ì˜¤ë‹µ 3ê°œ ë¬´ì‘ìœ„ ì„ íƒ (í˜„ì¬ ë‹¨ì–´ ì œì™¸)
            const incorrectOptions = ALL_WORD_DATA
                .filter(w => w.english !== correctAnswer)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(w => w.english);

            const options = [...incorrectOptions, correctAnswer].sort(() => Math.random() - 0.5);

            const appContainer = document.getElementById('appContainer');
            appContainer.innerHTML = `
                <div class="text-center mb-8">
                    <p class="text-2xl text-gray-600 mb-2">ë‹¤ìŒ ìš°ë¦¬ë§ì˜ ëœ»ì— ë§ëŠ” ì˜ë‹¨ì–´ëŠ”?</p>
                    <div class="text-5xl font-bold text-indigo-700 p-6 bg-indigo-50 rounded-xl shadow-lg inline-block">
                        ${currentQuestion.korean}
                    </div>
                </div>

                <div id="quizOptions" class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-xl mx-auto">
                    ${options.map((option, index) => `
                        <button class="quiz-option bg-white text-gray-800 text-xl font-semibold py-4 px-6 rounded-lg border-2 border-indigo-300 shadow-md transition transform duration-150 ease-in-out"
                                onclick="checkAnswer(this, '${option}', '${correctAnswer}')"
                                data-option="${option}">
                            ${option}
                        </button>
                    `).join('')}
                </div>
            `;
            updateStatus();
        }

        // ì •ë‹µ í™•ì¸
        function checkAnswer(selectedElement, selectedAnswer, correctAnswer) {
            // ... (Quiz answer checking logic) ...
            const optionsContainer = document.getElementById('quizOptions');
            const allOptions = optionsContainer.querySelectorAll('.quiz-option');

            // ëª¨ë“  ë²„íŠ¼ ë¹„í™œì„±í™”
            allOptions.forEach(btn => btn.disabled = true);

            quizTotal++; // ì •ë‹µ í™•ì¸ ì‹œë„ íšŸìˆ˜ ì¦ê°€

            let nextAction;
            let title;
            let message;

            if (selectedAnswer === correctAnswer) {
                quizScore++;
                selectedElement.classList.add('correct');
                title = 'ì •ë‹µ!';
                message = `ì¶•í•˜í•©ë‹ˆë‹¤! '${correctAnswer}'ê°€ ë§ìŠµë‹ˆë‹¤.`;
            } else {
                selectedElement.classList.add('incorrect');
                // ì •ë‹µ í‘œì‹œ
                allOptions.forEach(btn => {
                    if (btn.dataset.option === correctAnswer) {
                        btn.classList.add('correct');
                    }
                });
                title = 'ì˜¤ë‹µ!';
                message = `ì•„ì‰½ë„¤ìš”. ì •ë‹µì€ '${correctAnswer}'ì˜€ìŠµë‹ˆë‹¤.`;
            }
            
            // ë‹¤ìŒ í–‰ë™ ê²°ì •: í€´ì¦ˆê°€ ëë‚¬ëŠ”ì§€ í™•ì¸
            if (quizTotal >= words.length) {
                // ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ í’€ì—ˆìœ¼ë©´ ìµœì¢… ê²°ê³¼ í‘œì‹œ
                nextAction = showQuizResult; 
            } else {
                // ë‹¤ìŒ ë¬¸ì œë¡œ ì´ë™
                nextAction = renderQuiz;
            }
            
            updateStatus();
            // ëª¨ë‹¬ í‘œì‹œ ì‹œ ì½œë°± ëŒ€ì‹  ë‹¤ìŒ ì•¡ì…˜ì„ ì‹¤í–‰í•  í•¨ìˆ˜ë¥¼ ì €ì¥
            showModal(title, message, nextAction); 
        }

        // í€´ì¦ˆ ìµœì¢… ê²°ê³¼ í‘œì‹œ
        function showQuizResult() {
            // ... (Quiz result logic) ...
            const appContainer = document.getElementById('appContainer');
            const percentage = words.length > 0 ? ((quizScore / words.length) * 100).toFixed(1) : 0;

            document.getElementById('resultModal').classList.add('hidden'); 

            appContainer.innerHTML = `
                <div class="text-center mt-10 p-8 bg-green-50 rounded-xl border-4 border-green-300 shadow-lg">
                    <h2 class="text-3xl font-bold text-green-700 mb-4">ğŸ‰ í€´ì¦ˆ ì™„ë£Œ! ğŸ‰</h2>
                    <p class="text-2xl text-gray-700 mb-2">ì´ ë¬¸ì œ ìˆ˜: ${words.length}ê°œ</p>
                    <p class="text-2xl text-gray-700 mb-6">ë§íŒ ê°œìˆ˜: ${quizScore}ê°œ</p>
                    <p class="text-4xl font-extrabold text-green-600">ì ìˆ˜: ${percentage}%</p>
                    <button onclick="resetApp()" class="mt-8 px-6 py-3 bg-indigo-500 text-white font-semibold rounded-lg hover:bg-indigo-600 shadow-md">
                        ë‹¤ì‹œ ì‹œì‘í•˜ê¸°
                    </button>
                </div>
            `;
            document.getElementById('wordStatus').textContent = `ìµœì¢… ì ìˆ˜: ${quizScore} / ${words.length}`;
        }


        // --- Word Game 1 Mode Functions (Simplified) ---

        // ë‹¨ì–´ë¥¼ ì„ëŠ” í•¨ìˆ˜
        function scrambleWord(word) {
            let parts = word.split('');
            for (let i = parts.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [parts[i], parts[j]] = [parts[j], parts[i]];
            }
            return parts.join('');
        }
        
        // ë‹¤ìŒ ê²Œì„ ë‹¨ì–´ë¡œ ì´ë™
        function nextGameWord() {
            if (gameTotal >= words.length) {
                showGameResult();
                return;
            }

            currentGameWord = words[gameTotal];
            renderWordGame();
        }

        // ì˜ë‹¨ì–´ ê²Œì„ 1 ë Œë”ë§
        function renderWordGame() {
            if (!currentGameWord) return;

            const appContainer = document.getElementById('appContainer');
            const scrambled = scrambleWord(currentGameWord.english);
            
            appContainer.innerHTML = `
                <div class="max-w-md mx-auto space-y-6">
                    <div class="text-center">
                        <p class="text-2xl text-gray-600 mb-2">ì£¼ì–´ì§„ ë‹¨ì–´ì˜ ëœ»:</p>
                        <div class="text-4xl font-bold text-indigo-700 p-4 bg-indigo-50 rounded-xl shadow-lg">
                            ${currentGameWord.korean}
                        </div>
                    </div>

                    <div class="text-center p-4 bg-yellow-100 rounded-xl shadow-inner">
                        <p class="text-xl text-gray-700 mb-2">ì„ì¸ ì•ŒíŒŒë²³:</p>
                        <div id="scrambledDisplay" class="scrambled-word text-6xl font-extrabold text-gray-800">
                            ${scrambled.toUpperCase()}
                        </div>
                    </div>
                    
                    <div id="hintDisplay" class="text-center text-xl font-medium text-red-500 min-h-[1.5rem]"></div>

                    <div class="flex space-x-2">
                        <input type="text" id="wordInput" class="flex-grow p-4 text-2xl border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:ring-indigo-500 uppercase font-semibold text-center shadow-md" placeholder="ì—¬ê¸°ì— ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="${currentGameWord.english.length}" onkeyup="if(event.key==='Enter') submitGameAnswer()">
                        <button onclick="submitGameAnswer()" class="px-6 py-4 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition shadow-md">
                            ì œì¶œ
                        </button>
                    </div>

                    <div class="flex justify-center space-x-4">
                        <button onclick="provideHint()" class="px-4 py-2 bg-yellow-500 text-white font-semibold rounded-lg hover:bg-yellow-600 transition shadow-md">
                            íŒíŠ¸ ë³´ê¸° (ì²« ê¸€ì)
                        </button>
                        <button onclick="skipGameWord()" class="px-4 py-2 bg-gray-500 text-white font-semibold rounded-lg hover:bg-gray-600 transition shadow-md">
                            ê±´ë„ˆë›°ê¸°
                        </button>
                    </div>
                </div>
            `;
            document.getElementById('wordInput').focus();
            updateStatus();
        }

        // íŒíŠ¸ ì œê³µ
        function provideHint() {
            // ... (Game 1 hint logic) ...
            if (currentGameWord.hintUsed) return;

            const hint = currentGameWord.english.toUpperCase().charAt(0);
            document.getElementById('hintDisplay').textContent = `íŒíŠ¸: ì²« ê¸€ìëŠ” '${hint}'ì…ë‹ˆë‹¤.`;
            currentGameWord.hintUsed = true;
            hintCount++;
            updateStatus();
        }
        
        // ì •ë‹µ ì œì¶œ
        function submitGameAnswer() {
            // ... (Game 1 submit logic) ...
            const inputElement = document.getElementById('wordInput');
            const submittedAnswer = inputElement.value.toLowerCase().trim();
            const correctAnswer = currentGameWord.english.toLowerCase();

            gameTotal++;

            let nextAction;
            let title;
            let message;

            if (submittedAnswer === correctAnswer) {
                gameScore++;
                title = 'ì •ë‹µì…ë‹ˆë‹¤!';
                message = `ì„±ê³µ! '${correctAnswer.toUpperCase()}'ê°€ ë§ìŠµë‹ˆë‹¤.`;
            } else {
                title = 'ì˜¤ë‹µì…ë‹ˆë‹¤.';
                message = `í‹€ë ¸ìŠµë‹ˆë‹¤. ì •ë‹µì€ '${correctAnswer.toUpperCase()}'ì˜€ìŠµë‹ˆë‹¤.`;
            }

            if (gameTotal >= words.length) {
                nextAction = showGameResult; 
            } else {
                nextAction = nextGameWord;
            }
            
            updateStatus();
            showModal(title, message, nextAction); 
        }

        // ê±´ë„ˆë›°ê¸°
        function skipGameWord() {
            // ... (Game 1 skip logic) ...
            gameTotal++; // ê±´ë„ˆë›°ê¸°ë„ íšŸìˆ˜ì— í¬í•¨
            const nextAction = gameTotal >= words.length ? showGameResult : nextGameWord;
            const correctAnswer = currentGameWord.english.toUpperCase();
            
            showModal('ê±´ë„ˆë›°ê¸°', `ì •ë‹µì€ '${correctAnswer}'ì˜€ìŠµë‹ˆë‹¤. ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.`, nextAction);
        }

        // ê²Œì„ 1 ìµœì¢… ê²°ê³¼ í‘œì‹œ
        function showGameResult() {
            // ... (Game 1 result logic) ...
            const appContainer = document.getElementById('appContainer');
            const total = words.length;
            const percentage = total > 0 ? ((gameScore / total) * 100).toFixed(1) : 0;

            document.getElementById('resultModal').classList.add('hidden'); 

            appContainer.innerHTML = `
                <div class="text-center mt-10 p-8 bg-blue-50 rounded-xl border-4 border-blue-300 shadow-lg">
                    <h2 class="text-3xl font-bold text-blue-700 mb-4">ğŸ® ê²Œì„ ì¢…ë£Œ! ğŸ®</h2>
                    <p class="text-2xl text-gray-700 mb-2">ì´ ë¬¸ì œ ìˆ˜: ${total}ê°œ</p>
                    <p class="text-2xl text-gray-700 mb-2">ë§íŒ ê°œìˆ˜: ${gameScore}ê°œ</p>
                    <p class="text-xl text-gray-600 mb-6">íŒíŠ¸ ì‚¬ìš© íšŸìˆ˜: ${hintCount}íšŒ</p>
                    <p class="text-4xl font-extrabold text-blue-600">ì ìˆ˜: ${percentage}%</p>
                    <button onclick="resetApp()" class="mt-8 px-6 py-3 bg-indigo-500 text-white font-semibold rounded-lg hover:bg-indigo-600 shadow-md">
                        ë‹¤ì‹œ ì‹œì‘í•˜ê¸°
                    </button>
                </div>
            `;
            document.getElementById('wordStatus').textContent = `ìµœì¢… ì ìˆ˜: ${gameScore} / ${words.length}`;
        }


        // --- Word Game 2 Mode Functions (Falling Words) ---

        // ì˜ë‹¨ì–´ ê²Œì„ 2 ë Œë”ë§ (Canvas ì„¤ì •)
        function renderWordGame2() {
            if (words.length === 0) {
                document.getElementById('appContainer').innerHTML = '<p class="text-center text-xl text-gray-500 mt-10">ì„ íƒëœ ì¹´í…Œê³ ë¦¬ì— ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                document.getElementById('wordStatus').textContent = '';
                return;
            }

            const appContainer = document.getElementById('appContainer');
            appContainer.innerHTML = `
                <div class="game-area max-w-xl mx-auto space-y-4">
                    <canvas id="gameCanvas" width="${GAME_WIDTH}" height="${GAME_HEIGHT}"></canvas>
                    <div class="flex space-x-2 w-full">
                        <input type="text" id="game2Input" class="flex-grow p-3 text-xl border-2 border-gray-300 rounded-lg focus:border-green-500 focus:ring-green-500 uppercase font-semibold shadow-md" placeholder="ì—¬ê¸°ì— ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" onkeyup="if(event.key==='Enter') submitGame2Answer()">
                        <button onclick="submitGame2Answer()" class="px-4 py-2 bg-green-500 text-white font-bold rounded-lg hover:bg-green-600 transition shadow-md">
                            ì œì¶œ
                        </button>
                    </div>
                    <button id="startGame2Btn" onclick="startGame2()" class="w-full px-6 py-3 bg-indigo-500 text-white font-bold rounded-lg hover:bg-indigo-600 transition shadow-lg">
                        ê²Œì„ ì‹œì‘
                    </button>
                    <p class="text-sm text-center text-gray-600">Tip: ì•„ë˜ ì…ë ¥ì°½ì— ë–¨ì–´ì§€ëŠ” ë‹¨ì–´ë¥¼ ë¹ ë¥´ê²Œ ì…ë ¥í•˜ê³  Enter í‚¤ë¥¼ ëˆ„ë¥´ì„¸ìš”.</p>
                </div>
            `;

            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            updateStatus();
        }

        // ê²Œì„ 2 ì‹œì‘
        function startGame2() {
            if (isGameRunning) return;

            isGameRunning = true;
            gameScore2 = 0;
            wordsMissed = 0;
            wordsTyped = 0;
            fallingWords = [];
            lastSpawnTime = performance.now();
            
            document.getElementById('startGame2Btn').disabled = true;
            document.getElementById('game2Input').focus();

            // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì • (ë°˜ì‘í˜• ëŒ€ì‘)
            resizeCanvas(); 
            window.addEventListener('resize', resizeCanvas);

            // ê²Œì„ ë£¨í”„ ì‹œì‘
            gameLoopId = requestAnimationFrame(animateGame2);
        }
        
        // ìº”ë²„ìŠ¤ í¬ê¸° ì¡°ì •
        function resizeCanvas() {
             // ìº”ë²„ìŠ¤ ë¶€ëª¨ ìš”ì†Œì˜ ë„ˆë¹„ì— ë§ì¶¤ (ìµœëŒ€ GAME_WIDTH)
            const parentWidth = canvas.parentElement.clientWidth;
            const newWidth = Math.min(parentWidth, GAME_WIDTH);
            const scale = newWidth / GAME_WIDTH;
            
            canvas.style.width = `${newWidth}px`;
            canvas.style.height = `${GAME_HEIGHT * scale}px`;
            
            // ì‹¤ì œ ìº”ë²„ìŠ¤ í•´ìƒë„ëŠ” ìœ ì§€
            canvas.width = GAME_WIDTH;
            canvas.height = GAME_HEIGHT;
        }

        // ë‹¨ì–´ ìƒì„±
        function spawnWord() {
            if (words.length === 0) return;
            // ë¬´ì‘ìœ„ë¡œ ë‹¨ì–´ ì„ íƒ
            const wordData = words[Math.floor(Math.random() * words.length)];
            const englishWord = wordData.english;

            // í…ìŠ¤íŠ¸ ê¸¸ì´ì™€ í°íŠ¸ í¬ê¸°ë¥¼ ê³ ë ¤í•˜ì—¬ X ìœ„ì¹˜ ê²°ì •
            ctx.font = '24px Inter, sans-serif';
            const textWidth = ctx.measureText(englishWord.toUpperCase()).width;
            
            const x = Math.random() * (GAME_WIDTH - textWidth - 40) + 20; // 20px íŒ¨ë”©
            
            // ìƒ‰ìƒ ë¬´ì‘ìœ„ ì„ íƒ
            const colors = ['#fde047', '#34d399', '#f87171', '#60a5fa', '#a78bfa']; // Yellow, Green, Red, Blue, Purple
            const color = colors[Math.floor(Math.random() * colors.length)];
            
            // ì†ë„ ë¬´ì‘ìœ„ ì„ íƒ (ëŠë¦° ë‹¨ì–´ ~ ë¹ ë¥¸ ë‹¨ì–´)
            const speed = Math.random() * 0.5 + 0.5; // 0.5 to 1.0

            fallingWords.push({
                word: englishWord.toUpperCase(),
                english: englishWord.toLowerCase(),
                korean: wordData.korean,
                x: x,
                y: 0,
                speed: speed,
                color: color,
            });
        }

        // ê²Œì„ ë£¨í”„
        function animateGame2(timestamp) {
            if (!isGameRunning) return;

            // 1. í™”ë©´ ì§€ìš°ê¸°
            ctx.fillStyle = '#1f2937'; // Dark background
            ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);

            // 2. ë‹¨ì–´ ìƒì„± íƒ€ì´ë¨¸
            if (timestamp - lastSpawnTime > SPAWN_INTERVAL_MS) {
                spawnWord();
                lastSpawnTime = timestamp;
            }

            // 3. ë‹¨ì–´ ì´ë™ ë° ì¶©ëŒ ê°ì§€
            for (let i = fallingWords.length - 1; i >= 0; i--) {
                const word = fallingWords[i];
                word.y += word.speed;

                // ìº”ë²„ìŠ¤ ë°”ë‹¥ì— ë‹¿ì•˜ì„ ê²½ìš° (ë†“ì¹¨)
                if (word.y > GAME_HEIGHT) {
                    gameScore2 -= 15; // ê°ì 
                    wordsMissed++;
                    fallingWords.splice(i, 1); // ë‹¨ì–´ ì œê±°
                    // ë†“ì³¤ë‹¤ëŠ” ë©”ì‹œì§€ ì ì‹œ í‘œì‹œ
                    showMessage(`[${word.word}] ë†“ì¹¨! -15ì  (ëœ»: ${word.korean})`, 'red');
                    updateStatus();
                }

                // 4. ë‹¨ì–´ ê·¸ë¦¬ê¸°
                ctx.fillStyle = word.color;
                ctx.font = '24px Inter, sans-serif';
                ctx.fillText(word.word, word.x, word.y);
            }

            // 5. ì ìˆ˜ ë° ë©”ì‹œì§€ ê·¸ë¦¬ê¸°
            drawGameOverlay();

            // 6. ë‹¤ìŒ í”„ë ˆì„ ìš”ì²­
            gameLoopId = requestAnimationFrame(animateGame2);
        }

        // ê²Œì„ ì˜¤ë²„ë ˆì´ (ë©”ì‹œì§€) ê·¸ë¦¬ê¸°
        let messageTimer = 0;
        let currentMessage = '';
        let messageColor = 'white';

        function showMessage(text, color) {
            currentMessage = text;
            messageColor = color;
            messageTimer = 180; // ì•½ 3ì´ˆ (60fps ê¸°ì¤€)
        }

        function drawGameOverlay() {
            // ì¤‘ì•™ ë©”ì‹œì§€
            if (messageTimer > 0) {
                ctx.fillStyle = messageColor;
                ctx.font = '30px Inter, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(currentMessage, GAME_WIDTH / 2, GAME_HEIGHT / 2);
                messageTimer--;
            }
        }

        // ê²Œì„ 2 ì •ë‹µ ì œì¶œ ì²˜ë¦¬
        function submitGame2Answer() {
            const inputElement = document.getElementById('game2Input');
            const submittedAnswer = inputElement.value.toLowerCase().trim();
            inputElement.value = ''; // ì…ë ¥ì°½ ë¹„ìš°ê¸°
            
            if (submittedAnswer === "") return;

            // ë–¨ì–´ì§€ëŠ” ë‹¨ì–´ ë°°ì—´ì—ì„œ ì¼ì¹˜í•˜ëŠ” ë‹¨ì–´ ì°¾ê¸°
            const index = fallingWords.findIndex(word => word.english === submittedAnswer);

            if (index !== -1) {
                // ì •ë‹µ ì²˜ë¦¬
                const hitWord = fallingWords[index];
                gameScore2 += 10; // ë“ì 
                wordsTyped++;
                showMessage(`[${hitWord.word}] ì„±ê³µ! +10ì `, 'lime');
                
                fallingWords.splice(index, 1); // ë‹¨ì–´ ì œê±°
            } else {
                // ì˜¤ë‹µ ì²˜ë¦¬
                gameScore2 -= 5; // ì˜¤íƒ€ ê°ì 
                showMessage(`ì˜¤íƒ€: '${submittedAnswer.toUpperCase()}'ëŠ” ì—†ìŠµë‹ˆë‹¤. -5ì `, 'orange');
            }

            updateStatus();
            inputElement.focus();
        }


        // --- Utility Functions (Custom Modal) ---

        let modalCallback = null;

        function showModal(title, message, callback) {
            // Word Game 2 ì¤‘ì—ëŠ” ëª¨ë‹¬ì„ í‘œì‹œí•˜ì§€ ì•ŠìŒ (ê²Œì„ íë¦„ ë°©í•´)
            if (currentMode === 'wordgame2' && isGameRunning) return;

            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('resultModal').classList.remove('hidden');
            modalCallback = callback; 
        }
        
        // ì‚¬ìš©ìê°€ ëª¨ë‹¬ì˜ 'ê³„ì†í•˜ê¸°' ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ í˜¸ì¶œë¨
        function handleModalContinue() {
            document.getElementById('resultModal').classList.add('hidden');
            if (modalCallback) {
                const nextFunction = modalCallback;
                modalCallback = null; 
                nextFunction();
            }
        }
    </script>
</body>
</html>
